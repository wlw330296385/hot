{extend name="layout/common" /}

{block name="page-content"}
<div class="row">
    <div class="col-xs-12">
        <div class="box">
            
            <div class="box-header with-border">
                <h3 class="box-title">当前列表显示：
                <div class="btn-group">
                    <button type="button" class="btn btn-default">
                        {switch :input('param.status', 0)}
                            {case -1}已忽略的系统错误{/case}
                            {case 1}已修复的系统错误{/case}
                            {default /}待处理的系统错误
                        {/switch}
                    </button>
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
                        <span class="caret"></span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="?status=0">待处理的系统错误</a></li>
                        <li class="divider"></li>
                        <li><a href="?status=1">已修复的系统错误</a></li>
                        <li><a href="?status=-1">已忽略的系统错误</a></li>
                    </ul>
                </div>
                </h3>
            </div>
            <div class="box-body">
                <table id="myTable" class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>最后出错时间</th>
                            <th>出错次数</th>
                            <th>信息</th>
                            <th>报错文件</th>
                            <th>报错行</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        {volist name="list" id="item"}
                        <tr>
                            <td>{:date('Y-m-d H:i',$item.max)}</td>
                            <td>{$item.count}</td>
                            <td>{$item.message}</td>
                            <td>{$item.file}</td>
                            <td>{$item.line}</td>
                            <td><a href="{:url('admin/systemexception/info', 'id='.$item.id)}" class="btn btn-info">详细</button></td>
                        </tr>
                        {/volist}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{/block}

{block name="js"}
<script>
    $(document).ready( function () {
        $('#myTable').DataTable({
            'paging'      : true,
            'lengthChange': true,
            'searching'   : true,
            'ordering'    : false,
            'info'        : true,
            'autoWidth'   : false
        });
    });
</script>
{/block}