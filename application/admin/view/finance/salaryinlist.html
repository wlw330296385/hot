{extend name="layout/common"/}

{block name="page-content"}
<div class="panel panel-default panel-intro">
    <div class="panel-heading">
        <div class="panel-lead">
            <em>工资/收入列表</em>
            <p>上课学员人数=上课正式学员人数-抵扣赠课数</p>
            <p>主教练工资=班级主教练底薪+上课学员人数*班级设定提成基数（提成基数可为0）</p>
            <p>助教练工资=班级助教练底薪+上课学员人数*班级设定提成基数（提成基数可为0）</p>
            <p>直接收入=班级课程单价*上课学员人数*90%-主教练工资-助教练工资</p>
        </div>
    </div>
    <div class="panel-body">
        <div class="bootstrap-table">
            <div class="search-form">
                <form action="" class="form-inline" method="get">
                    <fieldset>
                        {if condition="!isset($curcamp)"}
                        <div class="form-group">
                            <label class="control-label">训练营</label>
                            <!--<input class="form-control" type="text" name="camp" >-->
                            <select name="camp_id" class="form-control">
                                <option value="">选择训练营</option>
                                {volist name="camplist" id="vo"}
                                <option value="{$vo.id}" {if condition="$camp_id eq $vo['id']"}selected{/if}>{$vo.camp}</option>
                                {/volist}
                            </select>
                        </div>
                        {/if}
                        <div class="form-group">
                            <label class="control-label">工资结算月份</label>
                            <input class="form-control layui-input" type="text" name="date" id="month-selecter1" value="{$curdate}">
                        </div>
                        <div class="form-group">
                            <label class="control-label">课时月份</label>
                            <input class="form-control layui-input" type="text" name="schedule_date" id="month-selecter2" value="{$curschedule_date}">
                        </div>
                        <!--<div class="form-group">
                            <label class="control-label">会员</label>
                            <input class="form-control" type="text" name="member" >
                        </div>-->
                        <div class="form-group">
                            <div class="col-sm-12 text-center">
                                <button type="submit" class="btn btn-success btn-flat">搜索</button>
                                <button type="submit" class="btn btn-default btn-flat">重置</button>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>

            <div class="fixed-table-container no-border">
                <div class="row">
                    <div class="col-md-12">
                        <div class="box no-border">
                            <div class="box-body">
                                <table class="table table-striped table-bordered table-hover">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>收入金额</th>
                                        <th>收入类型</th>
                                        <th>所属训练营</th>
                                        <th>会员</th>
                                        <th>会员姓名</th>
                                        <th>会员等级</th>
                                        <th>结算时间</th>
                                        <th>信息</th>
                                        <th>操作</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {volist name="list" id="vo"}
                                    <tr>
                                        <td>{$vo.id}</td>
                                        <td>{$vo.salary}{notempty name="vo.push_salary"}+{$vo.push_salary}{/notempty}</td>
                                        <td>
                                            {switch name="vo.type"}
                                            {case value="1"}教学{/case}
                                            {default/}其他
                                            {/switch}
                                        </td>
                                        <td>{$vo.camp}</td>
                                        <td>{$vo.member}</td>
                                        <td>{$vo.realname}</td>
                                        <td>{$vo.level}</td>
                                        <td>{$vo.create_time}</td>
                                        <td>
                                            {eq name="vo.type" value="1"}
                                            {$vo['member_type']}——课程：{$vo['lesson']['lesson']}（单价：{$vo['lesson']['cost']}）——班级：{$vo['schedule']['grade']}<br>课时{$vo['schedule']['lesson_time']}——正式学员人数{$vo['schedule']['num_student']}{notempty name="vo.system_remarks"}——{$vo.system_remarks}{/notempty}
                                             {/eq}
                                        </td>
                                        <td>
                                            <a href="{:url('schedule/detail', ['id' => $vo['schedule']['id']])}" class="btn btn-xs btn-info"><i class="fa fa-inbox"> 查看课时详情</i></a>
                                            <a href="{:url('finance/salaryin', ['id' => $vo['id']])}" class="btn btn-xs btn-info"><i class="fa fa-inbox"> 查看工资详情</i></a>
                                            <!--<a href="" class="btn btn-xs btn-danger del-btn"><i class="fa fa-trash"></i></a>-->
                                        </td>
                                    </tr>
                                    {/volist}
                                    </tbody>
                                </table>
                            </div>
                            <div class="box-footer clearfix">
                                {$page}
                            </div>

                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

{/block}
{block name="js"}
<script>
    $(function() {
        layui.use('laydate', function(){
            var laydate = layui.laydate;
            // 年月选择
            laydate.render({
                elem: '#month-selecter1',
                type: 'month'
            });
            laydate.render({
                elem: '#month-selecter2',
                type: 'month'
            });
        });
    });
</script>
{/block}