<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>统计图表</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--标准mui.css-->
    <link rel="stylesheet" href="/static/frontend/css/mui.min.css">
    <!--icon扩展样式icons-extra.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/icons-extra.css"/>
    <!--App自定义的css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/app.css"/>
    <!--自定义style.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/style.css"/>
    <style>
        .nav-list .colororange { font-size: 16px !important }
        small { font-size: 60%; }
    </style>
</head>

<body class="whitebg">

<div class="mui-content mt55">

        <!--操作模块-->
        <div class="img4x3" style="background-image: url({$campInfo['banner']})"></div>
        <!--图文导航-->
        <div class="page-header mui-text-center">
            <a href="{:url('camp/powerCamp',['camp_id'=>$camp_id])}" class="mui-icon mui-icon-left-nav mui-pull-left arrow" style="color: #737373;font-size: 21px"></a>
            <b class="f14">{$campInfo['camp']}统计概览</b>
        </div>
        <div class="nav-list">
            <div style="padding: 10px 10px;">
                <div id="segmentedControl" class="mui-segmented-control mui-segmented-control-negative">
                    <a class="mui-control-item mui-active" href="#item1">
                        本月
                    </a>
                    <a class="mui-control-item" href="#item2">
                        本年
                    </a>
                    <a class="mui-control-item" href="#item3">
                        全部
                    </a>
                </div>
            </div>
            <div id="item1" class="mui-control-content mui-active">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>营业额</span>
                            <div class="mui-media-body colororange">{$monthBill}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>课量</span>
                            <div class="mui-media-body colororange">{$monthSchedule}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>新增会员</span>
                            <div class="mui-media-body colororange">{$monthNewStudents}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>收益金额</span>
                            <div class="mui-media-body colororange">{$monthIncome}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>上课人次</span>
                            <div class="mui-media-body colororange">{$monthStudents}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>离营学员</span>
                            <div class="mui-media-body colororange">{$monthofflineStudents}</div>
                        </a>
                    </li>
                </ul>
            </div>
            <div id="item2" class="mui-control-content">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>营业额</span>
                            <div class="mui-media-body colororange">{$yearBill}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>课量</span>
                            <div class="mui-media-body colororange">{$yearSchedule}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>新增会员</span>
                            <div class="mui-media-body colororange">{$yearNewStudents}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>收益金额</span>
                            <div class="mui-media-body colororange">{$yearIncome}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>上课人次</span>
                            <div class="mui-media-body colororange">{$yearStudents}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>离营学员</span>
                            <div class="mui-media-body colororange">{$yearofflineStudents}</div>
                        </a>
                    </li>
                </ul>
            </div>
            <div id="item3" class="mui-control-content">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>营业额</span>
                            <div class="mui-media-body colororange">{$totalBill}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>课量</span>
                            <div class="mui-media-body colororange">{$totalSchedule}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>在线学员</span>
                            <div class="mui-media-body colororange">{$onlineStudents}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>收益金额</span>
                            <div class="mui-media-body colororange">{$totalIncome}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>上课人次</span>
                            <div class="mui-media-body colororange">{$totalStudents}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>累计学员</span>
                            <div class="mui-media-body colororange">{$campInfo['total_member']}</div>
                        </a>
                    </li>
                </ul>
            </div>
        </div>


        <!--图表模块-->
        <div class="page-header mui-text-center">
            <b class="f14">{:date('Y',time())}-{:date('m',time())} 营业额折线图</b>
        </div>
        <div id="turnoverMonth" style="min-height: 320px; width:100%; padding: 10px; background-color: #FFF;"></div>

        <div class="page-header mui-text-center">
            <b class="f14">{:date('Y',time())} 营业额折线图</b>
        </div>
        <div id="turnoverYear" style="min-height: 320px; width:100%; padding: 10px; background-color: #FFF;"></div>

        <div class="page-header mui-text-center">
            <b class="f14">训练点学员分布</b>
        </div>
        <div id="canvasLocation" style="min-height: 450px; width:100%; padding: 10px; background-color: #FFF;"></div>

        <div class="page-header mui-text-center">
            <b class="f14">课程购买占比</b>
        </div>
        <div id="canvasLesson" style="min-height: 450px; width:100%; padding: 10px; background-color: #FFF;"></div>





</div>
{layout name="Layout/footer"}
</body>
<script src="/static/frontend/js/mui.min.js"></script>
<script src="/static/frontend/js/jquery-3.2.1.min.js"></script>
<script>
    //初始化
    mui.init({
        swipeBack: true //启用右滑关闭功能
    });
</script>
<script src="/static/plugins/echart/echarts.min.js"></script>
<script src="/static/plugins/echart/hot.js"></script>


<script type="text/javascript">


    var date=new Date;
    var currYear=date.getFullYear();
    var currMonth=date.getMonth()+1;
    var currDate=date.getDate();
    var arrDate = new Array();
    for(var i=1;i<=currDate;i++){
        arrDate.push(i)
    }

    $(function () {


        /////////////////////////////////////////////////////////////////////////////////////// 营业额折线图（本月）


        var eventBill = JSON.parse('{$eventBill}');
        var lessonBill = JSON.parse('{$lessonBill}');
        var eventBillYear = JSON.parse('{$eventBillYear}');
        var lessonBillYear = JSON.parse('{$lessonBillYear}');
        var gradeCourtData = JSON.parse('{$gradeCourtData}');
        var lessonBuyData = JSON.parse('{$lessonBuyData}');
        var domTM = document.getElementById("turnoverMonth");
        var turnoverMonth = echarts.init(domTM, "hot");

        // 指定图表的配置项和数据
        optionTM = {
            title: {
                text: ''
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['培训', '活动']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: arrDate
            },
            yAxis: {
                type: 'value'
            },
            series: [
                {
                    name: '培训',
                    type: 'line',
                    data: lessonBill
                },
                {
                    name: '活动',
                    type: 'line',
                    data: eventBill
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        turnoverMonth.setOption(optionTM, true);


        /////////////////////////////////////////////////////////////////////////////////////// 营业额折线图（本年）


        var domTY = document.getElementById("turnoverYear");
        var turnoverYear = echarts.init(domTY, "hot");
        // 指定图表的配置项和数据
        optionTY = {
            title: {
                text: ""
            },
            tooltip: {
                trigger: 'axis'
            },
            legend: {
                data: ['培训', '活动']
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'category',
                boundaryGap: false,
                data: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月']
            },
            yAxis: {
                type: 'value'
            },
            series: [
                {
                    name: '培训',
                    type: 'line',
                    data: lessonBillYear
                },
                {
                    name: '活动',
                    type: 'line',
                    data: eventBillYear
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        turnoverYear.setOption(optionTY);


        /////////////////////////////////////////////////////////////////////////////////////// 学员分布


        var domLC = document.getElementById("canvasLocation");
        var canvasLocation = echarts.init(domLC, "hot");
        console.log(gradeCourtData.legend)
        // 指定图表的配置项和数据
        optionLCT = {
            title: {
                text: '',
                subtext: gradeCourtData.legend.length + '个训练点',
                x: 'right'
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data: gradeCourtData.legend
            },
            series: [
                {
                    name: '学生分布',
                    type: 'pie',
                    radius: '65%',
                    center: ['50%', '60%'],
                    data: gradeCourtData.series,
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };

        // 使用刚指定的配置项和数据显示图表。
        canvasLocation.setOption(optionLCT);

        /////////////////////////////////////////////////////////////////////////////////////// 学员分布

        var domLS = document.getElementById("canvasLesson");
        var canvasLesson = echarts.init(domLS, "hot");
        console.log(lessonBuyData)
        // 指定图表的配置项和数据
        optionLS = {
            title: {
                text: '',
                subtext: lessonBuyData.legend.length + '个课程',
                x: 'right'
            },
            tooltip: {
                trigger: 'item',
                formatter: "{a} <br/>{b} : {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                left: 'left',
                data: lessonBuyData.legend
            },
            series: [
                {
                    name: '学生分布',
                    type: 'pie',
                    radius: ['45%', '65%'],
                    center: ['50%', '60%'],
                    avoidLabelOverlap: false,
                    label: {
                        normal: {
                            show: false,
                            position: 'center'
                        },
                        emphasis: {
                            show: true,
                            textStyle: {
                                fontSize: '20',
                                fontWeight: 'bold'
                            }
                        }
                    },
                    labelLine: {
                        normal: {
                            show: false
                        }
                    },
                    data: lessonBuyData.series,
                    itemStyle: {
                        emphasis: {
                            shadowBlur: 10,
                            shadowOffsetX: 0,
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        }
                    }
                }
            ]
        };


        // 使用刚指定的配置项和数据显示图表。
        canvasLesson.setOption(optionLS);

        //自适应宽高
        window.addEventListener("resize", function () {
            turnoverMonth.resize();
            turnoverYear.resize();
            canvasLocation.resize();
            canvasLesson.resize();

        });

    })


</script>
</html>