<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>{$orgCampInfo.camp}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--标准mui.css-->
    <link rel="stylesheet" href="/static/frontend/css/mui.min.css">
    <!--icon扩展样式icons-extra.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/icons-extra.css" />
    <!--自定义style.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/style.css" />
    <!--顶部下滑菜单 menu-wrapper.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/menu.wrapper.css" />
    <!--选择器样式-->
    <link href="/static/frontend/css/mui.picker.min.css" rel="stylesheet" />
    <link href="/static/frontend/css/mui.poppicker.css" rel="stylesheet" />
    <!--自定义多色图标icon.js-->
    <script src="/static/frontend/iconfont/iconfont.js"></script>
    <style type="text/css">
        .coloricon {
            width: 2.7em;
            height: 2.7em;
            vertical-align: -0.7em;
            fill: currentColor;
            overflow: hidden;
        }

        .goConfirm .mui-media-body {
            height: 24px !important;
            line-height: 24px !important;
        }



        .mui-backdrop {
            background: rgba(0, 0, 0, 0.69)
        }

        @media screen and (min-width: 320px) {
            .imgShowEvent {
                width: 70% !important;
            }
        }

        @media screen and (min-width: 375px) {
            .imgShowEvent {
                width: 73% !important;
            }
        }

        @media screen and (min-width: 414px) {
            .imgShowEvent {
                width: 78% !important;
            }
        }

        .logRegOperation {
            padding: 2px 6px !important;
        }

        .search .mui-segmented-control .mui-control-item {
            width: 30%;
        }
    </style>
</head>

<body class="mt44">


    <!--首页-->
    <div class="mui-content mt55">
        <!--定位、搜索触发-->
        <header id="header" class="mui-bar mui-bar-nav search1">
            <div class="mui-pull-left mui-icon mui-icon-location" id="showCityPicker3">
                <span class="address" id="cityResult3">大热市</span>
            </div>
            <div class="mui-pull-left">
                <input type="search" id="search-input" placeholder="搜课程/活动/球场等">
            </div>
            <span class="mui-icon mui-icon-search searchicon" id="search-Btn"></span>
        </header>

        <div id="tabbar" class="mui-control-content mui-active">
            <!--图片轮播-->
            <div id="slider" class="mui-slider">
                <div class="mui-slider-group mui-slider-loop">
                    <!-- 额外增加的一个节点(循环轮播：第一个节点是最后一张轮播) -->
                    <div class="mui-slider-item mui-slider-item-duplicate">
                        <a href="#">
                            <img src="{$bannerList[0]['url']}">
                        </a>
                    </div>
                    <!-- 第一张 -->
                    {volist name="bannerList" id="vol"}
                    <div class="mui-slider-item">
                        <a href="">
                            <img src="{$vol.url}">
                        </a>
                    </div>
                    {/volist}
                    <!-- 额外增加的一个节点(循环轮播：最后一个节点是第一张轮播) -->
                    <div class="mui-slider-item mui-slider-item-duplicate">
                        <a href="#">
                            <img src="{$bannerList[2]['url']}">
                        </a>
                    </div>
                </div>
                <div class="mui-slider-indicator">
                    <div class="mui-indicator mui-active"></div>
                    <div class="mui-indicator"></div>
                    <div class="mui-indicator"></div>
                </div>
            </div>

            <!--图文导航-->
            <div class="nav-list mb">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame ptb4">
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('lesson/lessonListOfOrganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-course"></use>
                            </svg>
                            <div class="mui-media-body">课程</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('event/eventListOfOrganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-Collection"></use>
                            </svg>
                            <div class="mui-media-body">活动</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <div class="goConfirm">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-game"></use>
                            </svg>
                            <div class="mui-media-body">比赛</div>
                        </div>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('/keeper/Match/friendlylistOfOrganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-VS"></use>
                            </svg>
                            <div class="mui-media-body">约战</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('court/courtListOfOrganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-campus"></use>
                            </svg>
                            <div class="mui-media-body">校区</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('article/articleList')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-news"></use>
                            </svg>
                            <div class="mui-media-body">新闻</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('grade/gradeListoforganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-class"></use>
                            </svg>
                            <div class="mui-media-body">班级</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('/keeper/Team/teamlistOfOrganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-team"></use>
                            </svg>
                            <div class="mui-media-body">球队</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <a href="{:url('coach/coachListOfOrganization')}">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-coach"></use>
                            </svg>
                            <div class="mui-media-body">教练</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-3 navli">
                        <div class="goConfirm">
                            <svg class="coloricon" aria-hidden="true">
                                <use xlink:href="#icon-home-treasurechest"></use>
                            </svg>
                            <div class="mui-media-body">百宝箱</div>
                        </div>
                    </li>
                </ul>
            </div>
            <!-- 最新消息 -->
            <div class="page-header whitebg mb">
                <span class="course">欢迎荣光机构入驻篮球管家</span>
                <span class="more">
                    <a href="" class="mui-navigate-right">更多</a>
                </span>
            </div>

            <!-- 广告图 -->
            <div class="hot-ads">
                <img src="/static/frontend/images/ads1.jpg" />
            </div>

            <!-- 最新新闻 -->
            <div class="page-header whitebg border-b">
                <span class="course">最近新闻</span>
                <span class="more">
                    <a href="{:url('article/articleList')}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view list mainInfo newList"></ul>

            <!--最近训练-->
            <div class="page-header border-b">
                <span class="course">最近训练</span>
                <span class="more">
                    <a href="{:url('index/lastLyScheduleList')}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view list mainInfo newTrain"></ul>

            <!--最近赛事-->
            <div class="page-header border-b">
                <span class="course">最近赛事</span>
                <span class="more">
                    <a href="{:url('index/lastLyMatchList')}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view list mainInfo newMatch"></ul>

            <!--球队活动-->
            <div class="page-header border-b">
                <span class="course">球队活动</span>
                <span class="more pdr15">
                    <a href="{:url('index/lastLyEventList')}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view list mainInfo newEvent"></ul>

            <!--训练营活动-->
            <div class="page-header border-b">
                <span class="course">训练营活动</span>
                <span class="more pdr15">
                    <a href="{:url('index/lastLyCampEventList')}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view list mainInfo newCampEvent"></ul>

            <!--热门课程-->
            <div class="show-list mt mb">
                <div class="page-header border-b">
                    <span class="course">热门课程</span>
                    <span class="more">
                        <a href="{:url('lesson/lessonListOfOrganization')}" class="mui-navigate-right">更多</a>
                    </span>
                </div>
                <ul class="mui-table-view mui-grid-view show-list-cont" id="hot-lesson"></ul>
            </div>

            <!-- 《篮球管家》操作指南-->
            <div class="page-header whitebg">
                <a href="#" class="mui-navigate-right">
                    <span class="course">《篮球管家》操作指南</span>
                </a>
            </div>

        </div>
    </div>


    <div id="menu-wrapper" class="menu-wrapper hidden">
        <div id="menu" class="menu search">
            <!--搜索执行-->
            <header id="header-search" class="mui-bar mui-bar-nav search1" style="position: relative !important;">
                <div class="mui-pull-left mui-icon mui-icon-back" id="close-search"></div>
                <div class="mui-pull-left searchType">
                    搜
                    <span>课程</span>
                </div>
                <div class="mui-pull-left">
                    <input type="search" id="searchInput" class="mui-input-clear" placeholder="请输入搜索关键字">
                </div>
                <span class="mui-icon mui-icon-search searchicon" id="searchBtn"></span>
            </header>
            <div class="search">
                <div id="segmentedControl" class="mui-segmented-control">
                    <span class="mui-control-item mui-active choise-segment" s-table="/frontend/lesson/lessonListOfOrganization/">课程</span>
                    <span class="mui-control-item choise-segment" s-table="/frontend/court/courtListOfOrganization/">训练点</span>
                    <span class="mui-control-item choise-segment" s-table="/frontend/coach/coachListOfOrganization/">教练员</span>
                </div>

                <div class="hot-search">
                    <h4>热门搜索</h4>
                    <ul class="hot-search-frame">
                        <li s-keyword="154" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>兴趣班</span>
                        </li>
                        <li s-keyword="155" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>篮球基础</span>
                        </li>
                        <li s-keyword="156" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>篮球综合</span>
                        </li>
                        <li s-keyword="157" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>篮球强化</span>
                        </li>
                        <li s-keyword="83" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>初中基础</span>
                        </li>
                        <li s-keyword="84" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>初中综合</span>
                        </li>
                        <li s-keyword="165" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>花式篮球</span>
                        </li>
                        <li s-keyword="166" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>专项训练</span>
                        </li>
                        <li s-keyword="161" s-table="/frontend/lesson/lessonListOfOrganization/">
                            <span>成人私教</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div id="menu-backdrop" class="menu-backdrop"></div>

    <!--底部导航-->
    {layout name="Layout/footer"}
</body>
<script src="/static/frontend/js/mui.min.js"></script>
<script src="/static/frontend/js/jquery-3.2.1.min.js"></script>
<!--选择器-->
<script src="/static/frontend/js/mui.picker.min.js"></script>
<script src="/static/frontend/js/mui.poppicker.js"></script>
<script src="/static/frontend/js/common.js?v={:time()}"></script>
<script src="/static/frontend/js/city.data-3.js"></script>
<script>
    //初始化
    mui.init({
        swipeBack: true //启用右滑关闭功能
    });

    //    (function ($, doc) {
    //        $.init();
    //        $.ready(function () {
    //            var _getParam = function (obj, param) {
    //                return obj[param] || '';
    //            };
    //            ///级联示例
    //            var cityPicker3 = new $.PopPicker({
    //                layer: 3
    //            });
    //            cityPicker3.setData(cityData3);
    //            var showCityPickerButton = doc.getElementById('showCityPicker3');
    //            var cityResult3 = doc.getElementById('cityResult3');
    //            showCityPickerButton.addEventListener('tap', function (event) {
    //                cityPicker3.show(function (items) {
    //                    cityResult3.innerText = _getParam(items[1], 'text');
    //                    //返回 false 可以阻止选择框的关闭
    //                    //return false;
    //                    var areas = getAreas(_getParam(items[0], 'text'), _getParam(items[1], 'text'));
    //                    localStorage.currentArea = _getParam(items[2], 'text');
    //                    localStorage.currentCity = _getParam(items[1], 'text');
    //                    localStorage.currentProvince = _getParam(items[0], 'text');
    //                    localStorage.currentAreas = areas;
    //                    // //获取热门课程
    //                    toLessonList(localStorage.currentCity, localStorage.currentProvince);
    //                    // //获取热门训练营
    //                    // toCampList(localStorage.currentCity, localStorage.currentProvince);
    //                });
    //            }, false);
    //        });
    //    })(mui, document);

    //轮播
    var slider = mui("#slider");
    slider.slider({
        interval: 5000
    });
    mui("body").on("tap", "a", function () {
        window.top.location.href = this.href;
    });


    $(function () {

        //未开发提示
        $(".goConfirm").click(function () {
            mui.toast('暂未开放，敬请期待');
        })

        // if(window.localStorage){ alert("浏览支持localStorage") }else{ alert("浏览暂不支持localStorage") }

        //localStorage.clear();

        //获取定位省市区
        var getLocationTB = getCampLocationApi("{$orgCampInfo.province}", "{$orgCampInfo.city}", "{$orgCampInfo.area}");
        var sCity = getLocationTB['city'];
        $(".address").text(sCity);

        // //获取热门课程
        toLessonList();

        //提示框
        if ("{$memberInfo['id']}" == 0) {
            mui.confirm('请完善您的信息，以便进行后续操作，谢谢！', '提示', ['取消', '前往完善'], function (e) {
                if (e.index === 1) {
                    window.location.href = "{$fasturl}";
                }
            });
        }

        //搜索子页：类型选择
        $(".mui-segmented-control").find(".choise-segment").click(function () {
            $(".searchType span").text($(this).text());
        })
        //搜索子页：搜索提交
        $("#searchBtn").click(function () {
            var sKeyword = $("#searchInput").val();
            if (sKeyword == 0) {
                mui.toast('请输入您要搜索的内容');
            } else {
                var getType = $(".mui-segmented-control .mui-active").attr("s-table");
                var searchUrl = getType + '?keyword=' + sKeyword;
                window.top.location.href = searchUrl;
            }
        });


        //热门搜索
        $(".hot-search ul li").click(function () {
            var gradecate_id = $(this).attr("s-keyword");
            var sUrl = $(this).attr("s-table");
            var searchUrl = sUrl + '?gradecate_id=' + gradecate_id;
            window.top.location.href = searchUrl;
        })



        //比赛报名功能
        $(document).on('tap', '.signupMatchBtn', function () {
            //判断是否登陆会员
            var match_id = matchid;
            mui.ajax("{:url('api/match/joinmatch')}", {
                data: {
                    match_id: matchid,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data);
                    if (data.code == 200) {
                        mui.alert('报名成功', '确定');
                    } else {
                        mui.toast(data.msg);
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        });

        //球队活动报名功能
        $(document).on('tap', '.signupEventBtn', function () {
            //判断是否登陆会员
            var event_id = eventid;
            mui.ajax("{:url('api/team/jointeamevent')}", {
                data: {
                    event_id: eventid,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data);
                    if (data.code == 200) {
                        mui.alert('报名成功', '确定');
                    } else {
                        mui.toast(data.msg);
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        });

        toNewList(); // 最近新闻
        toLastTrainList(); //最近训练
        toLastMatchList(); //最近比赛
        toLastEventList(); //最近活动
        toCampEventList(); //训练营活动
    })


    //拼接搜索地址
    function getSearchUrl(tb, ty, kw) {
        var searchUrl = '/frontend/' + tb + '/' + tb + 'List/?' + ty + '=' + kw;

    }

    //搜索子页面
    var menuWrapper = document.getElementById("menu-wrapper");
    var menu = document.getElementById("menu");
    var menuWrapperClassList = menuWrapper.classList;
    var backdrop = document.getElementById("menu-backdrop");
    backdrop.addEventListener('tap', toggleMenu);
    var closeSearch = document.getElementById("close-search");
    closeSearch.addEventListener('tap', toggleMenu);
    document.getElementById("search-input").addEventListener('tap', toggleMenu);
    document.getElementById("search-Btn").addEventListener('tap', toggleMenu);

    var busying = false;
    function toggleMenu() {
        if (busying) {
            return;
        }
        busying = true;
        if (menuWrapperClassList.contains('mui-active')) {
            document.body.classList.remove('menu-open');
            menuWrapper.className = 'menu-wrapper fade-out-up animated';
            menu.className = 'menu bounce-out-up animated';
            setTimeout(function () {
                backdrop.style.opacity = 0;
                menuWrapper.classList.add('hidden');
            }, 500);
        } else {
            document.body.classList.add('menu-open');
            menuWrapper.className = 'menu-wrapper fade-in-down animated mui-active';
            menu.className = 'menu bounce-in-down animated';
            backdrop.style.opacity = 1;
        }
        setTimeout(function () {
            busying = false;
        }, 500);
    }


    var member_id = "{$memberInfo.id}"
    var camp_id = "{$o_id}"

    //获取热门课程并追加到页面
    var toLessonList = function () {
        var url = "{:url('api/lesson/getHotLessonListApi','','',true)}";
        mui.ajax({
            url: url,
            data: {
                status: 1,
                hot: 1,
                camp_id: camp_id,
                isprivate: 0
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            headers: { 'Content-Type': 'application/json' },
            //processData:false,
            success: function (data) {
                if (data.code == 200) {
                    var newli = '';
                    for (var i = 0; i <= data.data.length - 1; i++) {
                        var urls = "{:url('lesson/lessonInfo')}" + '/lesson_id/' + data.data[i].id;
                        newli = newli + '<li class="mui-table-view-cell mui-media mui-col-xs-6"><a href="' + urls + '"><div class="img4x3" style="background-image:url(' + data.data[i].cover + ')"></div><div class="mui-media-body typename">' + data.data[i].lesson + '</div><div class="frame"><span class="typename-num">已报名：' + data.data[i].students + '</span><span class="typename-money">￥' + data.data[i].cost + '</span></div></a></li>'
                    }
                    if (newli == '') {
                        newli = '<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>没有相关数据哦</p></li>'
                    }
                    $("ul#hot-lesson").html(newli);

                } else {
                    newli = '<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>没有相关数据哦</p></li>';
                    $("ul#hot-lesson").html(newli);
                }

            },
            error: function (xhr, type, errerThrown) {
                mui.toast('网络异常,请稍候再试');
            }
        });
    };

    //获取最近一条新闻
    function toNewList() {
        mui.ajax("{:url('api/article/getArticleListByPageApi')}", {
            data: {
                organization_type: 2,
                organization_id: camp_id,
                status: 1
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            headers: { 'Content-Type': 'application/json' },
            success: function (data) {
                console.log(data)
                var div = '';
                if (data.code == 200) {
                    // 将时间戳转成日期格式
                    for (var i = 0; i <= data.data.data.slice(0, 3).length - 1; i++) {
                        let urls = "{:url('article/articleInfo')}" + "/article_id/" + data.data.data[i].id;
                        div += '<li class="mui-table-view-cell listli"><a href="' + urls + '"><img class="mui-pull-left proportion4x3" src="' + data.data.data[i].covers + '"><div style="line-height:26px;"><strong>' + data.data.data[i].title + '</strong>';
                        div += '<p class="mui-ellipsis f12">' + data.data.data[i].create_time + '<span class="wd45"><font style="margin-right: 8px !important;"><i class="mui-icon-extra mui-icon-extra-comment f14"></i>&nbsp;' + data.data.data[i].comments + '</font><font><i class="mui-icon-extra mui-icon-extra-like f14"></i>&nbsp;' + data.data.data[i].likes + '</span></span></p></div>';
                        div += '</a></li>';
                    }
                    $(".newList").empty().append(div);
                    if (div == '') {
                        $(".newList").empty().append('<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>还没有新闻数据哦</p></li>');
                    }
                }
            },
            error: function (xhr, type, errorThrown) {
                //异常处理；
                console.log(type);
            }
        });
    };

    //获取最近一条训练
    function toLastTrainList() {
        var page = 1
        var url = "{:url('api/schedule_member/getScheduleMemberListWithScheduleByPageApi','','',true)}" + '/?page=' + page;
        mui.ajax({
            url: url,
            data: {
                camp_id: camp_id,
                member_id: member_id,
                status: 1,
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            headers: { 'Content-Type': 'application/json' },
            success: function (data) {
                console.log(data)
                var newli = '';
                if (data.code == 200) {
                    if (data.data.data == '') {
                        $(".newTrain").empty().append('<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>还没有已完成的课时数据哦</p></li>');
                    } else {
                        var lesson_time = data.data.data[0].lesson_time;
                        var date = new Date();
                        var monthNum = date.getMonth(lesson_time) + 1;;
                        if (monthNum < 10) {
                            var Tmonth = "0" + monthNum;
                        } else {
                            var Tmonth = monthNum;
                        }
                        var dayNum = date.getDate(lesson_time);
                        if (dayNum < 10) {
                            var Tday = "0" + dayNum;
                        } else {
                            var Tday = dayNum;
                        }
                        var hoursNum = date.getHours(lesson_time)
                        var minutesNum = date.getMinutes(lesson_time)
                        if (hoursNum < 10) {
                            var Ttime = "0" + date.getHours(lesson_time) + ":" + date.getMinutes(lesson_time);
                        } else if (minutesNum < 10) {
                            var Ttime = date.getHours(lesson_time) + ":" + "0" + date.getMinutes(lesson_time);
                        } else if (hoursNum < 10 && minutesNum < 10) {
                            var Ttime = "0" + date.getHours(lesson_time) + ":" + "0" + date.getMinutes(lesson_time);
                        } else {
                            var Ttime = date.getHours(lesson_time) + ":" + date.getMinutes(lesson_time);
                        }
                        var urls = "{:url('schedule/scheduleInfo')}/" + "schedule_id/" + data.data.data[0].id + "/camp_id/" + data.data.data[0].camp_id;
                        newli += ' <a href="' + urls + '"><li class="mui-table-view-cell mui-media listli liFrame"><div class="mainInfoLeft fl mui-text-center">';
                        newli += '<p class="month bgblack">' + Tmonth + '月</p><h1 class="day colorred">' + Tday + '</h1><p class="hours">' + Ttime + '</p>';
                        newli += '</div><div class="mui-media-body mainInfoRight wd66"><h5 class="title">' + data.data.data[0].schedule.grade + '</h5><div class="divFrame"><p>教练：' + data.data.data[0].schedule.coach + '</p>';
                        newli += '<p>上课地点：' + data.data.data[0].schedule.court + '</p><p>所属课程：' + data.data.data[0].schedule.lesson + '</p></div><div class=opFrame></div></div></li>';
                        $(".newTrain").empty().append(newli);
                    }
                }
            },
            error: function (xhr, type, errorThrown) {
                //异常处理；
                console.log(type);
            }
        });
    };

    var matchid = ''
    //获取最近一条比赛
    function toLastMatchList() {
        mui.ajax("{:url('api/team/lastcampteammatch')}", {
            data: {
                camp_id: camp_id,
                member_id: member_id,
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            headers: { 'Content-Type': 'application/json' },
            success: function (data) {
                console.log(data)
                var div = '';
                if (data.code == 200) {
                    // 将时间戳转成日期格式
                    var Tmonth = gettimem(data.data[0].match_timestamp * 1000);
                    var Tday = gettimed(data.data[0].match_timestamp * 1000);
                    var Ttime = gettimeh(data.data[0].match_timestamp * 1000);
                    matchid = data.data[0].match_id
                    var url = "{:url('keeper/team/matchinfo')}" + '/team_id/' + data.data[0].team_id + '/match_id/' + data.data[0].match_id;
                    div += ' <li class="mui-table-view-cell mui-media listli liFrame"><div class="mainInfoLeft fl mui-text-center">';
                    if (data.data[0].match_time == 0) {
                        div += '<p class="month bgblack">0月</p><h1 class="day" style="font-size: 25px;padding: 15px 21px;">待定</h1><p class="hours">00:00</p>';
                    } else {
                        div += '<p class="month bgblack">' + Tmonth + '月</p><h1 class="day colorred">' + Tday + '</h1><p class="hours">' + Ttime + '</p>';
                    }
                    div += '</div><div class="mui-media-body mainInfoRight wd66"><h5 class="title">' + data.data[0].match + '</h5><div class="divFrame">';
                    div += '<p>发起人：' + data.data[0].home_team + '</p>';
                    div += '<p>比赛地点：' + data.data[0].court + '</p><p>比赛类型：' + data.data[0].type + '</p></div><div class=opFrame><button class="mui-btn opbtn" style="margin-right: 8px"><a href="' + url + '">详情</a></button>';
                    if (data.data[0].is_finished_num == 1) {
                        div += '<button class="mui-btn opbtn bggray">已结束</button>';
                    } else {
                        div += '<button class="mui-btn opbtn bgred signupMatchBtn">参加</button>';
                    }
                    div += ' </div></div></li>';
                    // 人员头像版块
                    div += '<li class="mui-table-view-cell listli liImgFrame"><div class="imgShow fl overflow-x imgShowEvent" style="padding:0 !important">';
                    for (var j = 0; j <= data.data[0].memberlist.length - 1; j++) {
                        div += '<img src="' + data.data[0].memberlist[j].avatar + '" alt="">';
                    }
                    div += '</div><span class="singUpTip"><font class="colorred reg_number">' + data.data[0].reg_number + '</font>/<font class="reg_all">' + data.data[0].max + '</font> 已报名</span></li>';
                    $(".newMatch").empty().append(div);
                }
                if (data.code == 100) {
                    $(".newMatch").empty().append('<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>还没有比赛数据，赶紧去创建比赛吧</p></li>');
                }
            },
            error: function (xhr, type, errorThrown) {
                //异常处理；
                console.log(type);
            }
        });
    };

    var eventid = ''
    //球队活动
    function toLastEventList() {
        mui.ajax("{:url('api/team/lastcampteamevent')}", {
            data: {
                camp_id: camp_id,
                member_id: member_id,
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            headers: { 'Content-Type': 'application/json' },
            success: function (data) {
                console.log(data)
                var div = '';
                if (data.code == 200) {
                    // 将时间戳转成日期格式
                    var Tmonth = gettimem(data.data[0].start_time_stamp * 1000);
                    var Tday = gettimed(data.data[0].start_time_stamp * 1000);
                    var Ttime = gettimeh(data.data[0].start_time_stamp * 1000);
                    eventid = data.data[0].id
                    var url = "{:url('keeper/team/eventinfo')}" + '/team_id/' + data.data[0].team_id + '/event_id/' + data.data[0].id;
                    div += ' <li class="mui-table-view-cell mui-media listli liFrame"><div class="mainInfoLeft fl mui-text-center"><p class="month bgblack">' + Tmonth + '月</p><h1 class="day colorgreen">' + Tday + '</h1><p class="hours">' + Ttime + '</p></div>';
                    div += '<div class="mui-media-body mainInfoRight wd66"><h5 class="title">' + data.data[0].event + '</h5>';
                    div += '<div class="divFrame"><p>发起人：' + data.data[0].member + '</p><p>活动地点：' + data.data[0].location + '</p><p>活动类型：' + data.data[0].event_type + '</p></div><div class=opFrame><button class="mui-btn opbtn" style="margin-right: 8px"><a href="' + url + '">详情</a></button>';
                    if (data.data[0].is_finished_num == 1) {
                        div += '<button class="mui-btn opbtn bggray">已结束</button>';
                    } else {
                        div += '<button class="mui-btn opbtn bggreen signupEventBtn">参加</button>';
                    }
                    div += ' </div></div></li>';
                    // 人员头像版块
                    div += '<li class="mui-table-view-cell listli liImgFrame"><div class="imgShow fl overflow-x imgShowEvent" style="padding:0 !important">';
                    for (var j = 0; j <= data.data[0].memberlist.length - 1; j++) {
                        div += '<img src="' + data.data[0].memberlist[j].avatar + '" alt="">';
                    }
                    div += '</div><span class="singUpTip"><font class="colorred reg_number">' + data.data[0].reg_number + '</font>/<font class="reg_all">' + data.data[0].max + '</font> 已报名</span></li>';
                    $(".newEvent").empty().append(div);
                }
                if (data.code == 100) {
                    $(".newEvent").empty().append('<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>还没有活动数据，赶紧去创建活动吧</p></li>');
                }
            },
            error: function (xhr, type, errorThrown) {
                //异常处理；
                console.log(type);
            }
        });
    };

    //训练营活动
    // var camp_event_id = '';
    function toCampEventList() {
        mui.ajax("{:url('api/event/getHotEventList')}", {
            data: {
                organization_id: camp_id,
                member_id: member_id,
            },
            dataType: 'json',//服务器返回json格式数据
            type: 'post',//HTTP请求类型
            timeout: 10000,//超时时间设置为10秒；
            headers: { 'Content-Type': 'application/json' },
            success: function (data) {
                console.log(data)
                var div = '';
                if (data.code == 200) {
                    // 将时间戳转成日期格式
                    var event_time = data.data[0].event_times;
                    var date = new Date();
                    var monthNum = date.getMonth(event_time) + 1;;
                    if (monthNum < 10) {
                        var Tmonth = "0" + monthNum;
                    } else {
                        var Tmonth = monthNum;
                    }
                    var dayNum = date.getDate(event_time);
                    if (dayNum < 10) {
                        var Tday = "0" + dayNum;
                    } else {
                        var Tday = dayNum;
                    }
                    var hoursNum = date.getHours(event_time)
                    var minutesNum = date.getMinutes(event_time)
                    if (hoursNum < 10) {
                        var Ttime = "0" + date.getHours(event_time) + ":" + date.getMinutes(event_time);
                    } else if (minutesNum < 10) {
                        var Ttime = date.getHours(event_time) + ":" + "0" + date.getMinutes(event_time);
                    } else if (hoursNum < 10 && minutesNum < 10) {
                        var Ttime = "0" + date.getHours(event_time) + ":" + "0" + date.getMinutes(event_time);
                    } else {
                        var Ttime = date.getHours(event_time) + ":" + date.getMinutes(event_time);
                    }
                    // camp_event_id = data.data[0].id
                    var url = "{:url('event/eventinfo')}" + '/event_id/' + data.data[0].id;
                    div += ' <li class="mui-table-view-cell mui-media listli liFrame"><a href="' + url + '"><div class="mainInfoLeft fl mui-text-center"><p class="month bgblack">' + Tmonth + '月</p><h1 class="day colorgreen">' + Tday + '</h1><p class="hours">' + Ttime + '</p></div>';
                    div += '<div class="mui-media-body mainInfoRight wd66"><h5 class="title">' + data.data[0].event + '</h5>';
                    div += '<div class="divFrame"><p>发起人：' + data.data[0].member + '</p><p>活动地点：' + data.data[0].location + '</p><p>活动类型：' + data.data[0].event_type + '</p></div>';
                    // div += '<div class=opFrame><button class="mui-btn opbtn" style="margin-right: 8px"><a href="' + url + '">详情</a></button>';
                    // if (data.data[0].is_finished_num == 1) {
                    //     div += '<button class="mui-btn opbtn bggray">已结束</button>';
                    // } else {
                    //     div += '<button class="mui-btn opbtn bggreen signupCampEventBtn">参加</button>';
                    // }
                    div += ' </div></div></a></li>';
                    // 人员头像版块
                    div += '<li class="mui-table-view-cell listli liImgFrame"><div class="imgShow fl overflow-x imgShowEvent" style="padding:0 !important">';
                    for (var j = 0; j <= data.data[0].event_member.length - 1; j++) {
                        div += '<img src="' + data.data[0].event_member[j].avatar + '" alt="">';
                    }
                    div += '</div><span class="singUpTip"><font class="colorred reg_number">' + data.data[0].participator + '</font>/<font class="reg_all">' + data.data[0].max + '</font> 已报名</span></li>';
                    $(".newCampEvent").empty().append(div);
                }
                if (data.code == 100) {
                    $(".newCampEvent").empty().append('<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>还没有活动数据，赶紧去创建活动吧</p></li>');
                }
            },
            error: function (xhr, type, errorThrown) {
                //异常处理；
                console.log(type);
            }
        });
    };

    //创建补0函数
    function p(s) {
        return s < 10 ? '0' + s : s;
    }
    function gettimem(m) {
        var _time = new Date(m);
        var month = _time.getMonth() + 1;
        return p(month);
    }
    function gettimed(d) {
        var _time = new Date(d);
        var day = _time.getDate();
        return p(day);
    }
    function gettimeh(h) {
        var _time = new Date(h);
        var hours = _time.getHours();
        var minutes = _time.getMinutes();
        return p(hours) + ":" + p(minutes);
    }
    // 将时间戳转成日期格式
    function gettimeM(M) {
        var _time = new Date(M);
        var month = _time.getMonth() + 1;
        var day = _time.getDate();
        return p(month) + "月" + p(day) + "日"
    }
    function gettimeY(Y) {
        var _time = new Date(Y);
        var year = _time.getFullYear();
        return p(year) + "年";
    }


</script>

</html>