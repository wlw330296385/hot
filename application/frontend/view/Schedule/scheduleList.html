<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>课时列表</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--标准mui.css-->
    <link rel="stylesheet" href="/static/frontend/css/mui.min.css">
    <!--icon扩展样式icons-extra.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/icons-extra.css"/>
    <!--App自定义的css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/app.css"/>
    <!--自定义style.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/style.css"/>
</head>

<body>

    <div class="mui-content">

        <div class="list camp-list camp-lesson-list detalis-list coach">

            <div class="camp-lesson-list">
                <div id="segmentedControl" class="mui-segmented-control mb">
                    <a class="mui-control-item mui-active" href="#item2">我的课时</a>
                    <a class="mui-control-item" href="#item3">训练营</a>
                </div>
            </div>

            <div class="nav-list">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4"><a href="#">
                        <span>本月课量</span>
                        <div class="mui-media-body">23</div>
                    </a></li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4"><a href="#">
                        <span>本年课量</span>
                        <div class="mui-media-body">35</div>
                    </a></li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4"><a href="#">
                        <span>总课量</span>
                        <div class="mui-media-body">352</div>
                    </a></li>
                </ul>
            </div>

            <ul id="OA_task_schedulist" class="mui-table-view mui-text-center">

                <li class="mui-table-view-cell">
                    <ul class="mui-row table">
                        <li class="mui-col-xs-2">状态</li>
                        <li class="mui-col-xs-4">日期</li>
                        <li class="mui-col-xs-4">班级</li>
                        <li class="mui-col-xs-2">人数</li>
                    </ul>
                </li>

                {volist name="scheduleList" id="vol"}
               
                    <li class="mui-table-view-cell">
                        <div class="mui-slider-right mui-disabled">
                            <span class="mui-btn mui-btn-red">删除</span>
                        </div>
                        <div class="mui-slider-handle">
                         <a href="{:url('schedule/scheduleInfo',['schedule_id'=>$vol['id'],'camp_id'=>$vol['camp_id']])}" style="display: block;">
                            <ul class="mui-row table">
                                <li class="mui-col-sm-2 mui-col-xs-2"><i class="mui-icon mui-icon-checkmarkempty"></i></li>
                                <li class="mui-col-sm-4 mui-col-xs-4 ">{$vol.lesson_date}</li>
                                <li class="mui-col-sm-4 mui-col-xs-4 ">{$vol.grade}</li>
                                <li class="mui-col-sm-2 mui-col-xs-2 ">{$vol.students}</li>
                            </ul>
                            </a>
                        </div>
                    </li>
                
                {/volist}

            </ul>

        </div>

    </div>

    <!--底部导航-->
    {layout name="Layout/footer"}
    <script src="/static/frontend/js/mui.min.js"></script>
    <script src="/static/frontend/js/jquery-3.2.1.min.js"></script>  
    <script>
        //初始化
        mui.init({
            swipeBack: true //启用右滑关闭功能
        });

         //拖拽后显示操作图标，点击操作图标删除元素；
         $('#OA_task_schedulist').on('tap', '.mui-btn', function(event) {
            var elem = this;
            var li = elem.parentNode.parentNode;
            var btnArray = ['确认', '取消'];
            var url  = "{:url('api/schedule/removeschedule')}";
            var scheduleid = $(this).attr("data-id");
            mui.confirm('确认删除该课时？', '提示', btnArray, function(e) {
                if (e.index == 0) {
                    mui.ajax({
                        url:url,
                        data: {
                            "scheduleid":scheduleid
                        },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: {'Content-Type': 'application/json'},
                    success: function (data) {
                        console.log(data);
                        if (data.code == 200) {
                            console.log(data);
                            li.parentNode.removeChild(li);
                        } else {
                            mui.toast(data.msg);
                        }
                    },
                    error: function(xhr, type, errerThrown) {
                        mui.toast('网络异常,请稍候再试');
                    }
                });

                } else {
                    setTimeout(function() {
                        $.swipeoutClose(li);
                    }, 0);
                }
            });
        });
    </script>
</body>
</html>