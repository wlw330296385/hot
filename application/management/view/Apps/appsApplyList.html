{extend name="layout/common"/}
{block name="css"}
<style>
	.diyList{
		display: block;
		overflow: hidden;
		white-space:nowrap;
	}
	.table img { width: 32px;}
	.mixContent, .mixContentTitle {
		display: none;
	}
	.eventDoms button{
		padding: 5px 8px;
	}
</style>
{/block}
{block name="page-content"}

<div class="panel panel-default panel-intro">
    <div class="panel-heading">
        <div class="panel-lead">
            <em></em>
        </div>
    </div>
    <div class="panel-body">
        	<div class="row" style="padding:10px 15px;">
	        	<!-- 搜索框 -->
	        	<div class="search-form col-md-12">
	                <form class="form-inline schedule-list" method="get">
	                    <fieldset>
	                         <div class="btn-group">
			                  <button type="button" class="btn btn-success" id="field">{$field}</button>
			                  <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
			                    <span class="caret"></span>
			                    <span class="sr-only">Toggle Dropdown</span>
			                  </button>
			                  <ul class="dropdown-menu search_opt" role="menu">
			                    <li data = 'title'><a href="#">标题</a></li>
			                    <li class="divider" ></li>
			                    <li data = 'organization'><a href="#" >所属组织</a></li>
			                  </ul>
			                </div>
	                        <div class="form-group">
	                            <input class="form-control" type="text" name="keyword" required="required">
	                            <input type="hidden" name="field" value="">
	                        </div>
	                        <div class="form-group">
	                            <div class="col-sm-12 text-center">
	                                <input type="submit" class="btn btn-success btn-flat btn-sub search" value="搜索">
	                                <input type="reset" class="btn btn-default btn-flat" value="重置">
	                            </div>
	                        </div>

                        	<div class="form-group">
								<div class="col-sm-12 col-md-12">
									<p class="eventDoms">分类统计：{volist name="$info.doms" id="vol"}
									<button>{$vol.name}</button>
									{/volist}</p>
								</div>
                        	</div>
	                    </fieldset>
	                </form>

	            </div>
	            
            </div>	
            <!-- 主体 -->
            <div class="box-body">
                <table class="table table-striped table-bordered table-hover">
                    <thead>
                    <tr>
                        <th class="order_by" data-order = 'id'>id</th>
						<th data-order = 'dom'>分类</th>
                        <th data-order = 'member'>会员名</th>
                        <th data-order = 'realname'>真实姓名</th>
                        <th class="mixContentTitle">详情</th>
                    </tr>
                    </thead>
                    <tbody>
                    {volist name="appsApplyList" id="vo"}
                    <tr>
                        <td>{$vo.id}</td>
						<td class="dom">{$vo.dom}</td>
                        <td>{$vo.member}</td>
                        <td>{$vo.realname}</td>
                        <td class="mixContent">
                            {$vo.content}
                        </td>
                    </tr>
                    {/volist}
                    </tbody>
                </table>
            </div>
	</div>
</div>
	
{/block}




{block name='js'}
<script type="text/javascript">
	$(function(){


        var newTH = 0;
        //遍历自定义项目重新排版输出
        $(".eventDoms").find("button").each(function () {
            newTH = newTH + "<th>"+$(this).find(".fTitle").html()+"</th>";
            console.log(newTH)
        });


	    var newTH = "";
        //遍历自定义项目名称输出
        $("tbody tr:first-child .mixContent").find("li").each(function () {
            newTH = newTH + "<th>"+$(this).find(".fTitle").html()+"</th>";
            console.log(newTH)
        });
        $(".mixContentTitle").after(newTH);


        var newTD = "";
        //遍历自定义项目重新排版输出
        $(".mixContent").each(function () {
            newTD = "";
            $(this).find("li").each(function () {
                newTD = newTD + "<td>"+$(this).find(".fValue").html()+"</td>";
            });
            $(this).after(newTD)
        });


	})
	
	var field = 'woo';
	$('.search_opt li').on('click',function(){
		field = $(this).attr('data');
		console.log(field);
		$('#field').text(field);
		$('input[type=hidden]').val(field)
	})

	$('input[type=reset]').on('click',function(){
		$('input[type=hidden]').val('woo');
		window.location.href="{:url('admin/article/articlelist')}";
	})

</script>
{/block}