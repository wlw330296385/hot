<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>{$camp_member.camp}管理系统</title>
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
	<!--adminlte style-->
	<link rel="stylesheet" href="/static/backend/adminlte/css/bootstrap.min.css">
	<link rel="stylesheet" href="/static/backend/adminlte/css/bootstrap-table.min.css">
	<link rel="stylesheet" href="/static/backend/plugins/font-awesome/css/font-awesome.min.css">
	<link rel="stylesheet" href="/static/backend/plugins/ionicons/css/ionicons.min.css">
	<link rel="stylesheet" href="/static/backend/adminlte/css/AdminLTE.min.css">
	<link rel="stylesheet" href="/static/backend/adminlte/css/skins/skin-blue.min.css">
	<link rel="stylesheet" href="/static/plugins/datatables/dataTables.bootstrap.css">
	<!-- layui -->
	<link rel="stylesheet" href="/static/backend/layui/css/layui.css">
	<!-- 自定义样式 -->
	<!-- layui -->
	<link rel="stylesheet" href="/static/backend/adminlte/css/master.css">
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
</head>
<body class="hold-transition skin-blue sidebar-mini">

<div class="row">

	<form role="form" method="post" style="margin-top: 20px;" action="">
	<div class="col-sm-12">
		<div class="box-body">

			<table class="table table-bordered table-striped dataTable">
				<tbody>
				<tr>
					<th>订单号</th>
					<th>会员名</th>
					<th>学生名</th>
				</tr>
				<tr>
					<td>{$refundInfo.bill.bill_order}</td>
					<td>{$refundInfo.member}</td>
					<td>{$refundInfo.student}</td>
				</tr>
				<tr>
					<th>商品名</th>
					<th>退款总数</th>
					<th>最大退款金额</th>
				</tr>
				<tr>
					<td>{$refundInfo.bill.goods}</td>
					<td>{$refundInfo.total}</td>
					<td><span class="maxSum">{$refundInfo.refundamount}</span>元</td>
				</tr>
				<tr>
					<th colspan="3">退费原因</th>
				</tr>
				<tr>
					<td colspan="3">{$refundInfo.reason}</td>
				</tr>
				</tbody>
			</table>


				<!-- text input -->
				<div class="form-group">
					<label>实际退费金额</label>
					<small class="getIncome" style="color:red; margin-left: 20px;"></small>
					<a class="pull-right" href="#" data-toggle="tooltip" data-placement="left" title="" data-original-title="实际退款不可大于可退金额，假设某学员可退10课时，原值1000元，经双方协商一致只可退还500，剩余500元，平台占10%，训练营占90%"><span class="fa fa-info-circle"></span> 特别说明</a>
					<input type="text" class="form-control" name="refund" placeholder="请填写实际退费金额 ...">
				</div>
				<!-- select -->
				<div class="form-group">
					<label>退费方式</label>
					<select class="form-control" name="refund_type">
						<option value="1">平台原路退回</option>
						<option value="2">银行转账退回</option>
						<option value="3">现金退回</option>
						<option value="4">支付宝</option>
						<option value="5">微信</option>
						<option value="6">其他</option>
					</select>
				</div>
				<!-- textarea -->
				<div class="form-group">
					<label>备注</label>
					<textarea class="form-control" rows="3" name="remarks" placeholder="请填写训练营备注 ..."></textarea>
				</div>

		</div>

		<div class="box-footer">
			<button class="btn btn-default closeModel">关闭</button>

			<input type="hidden" class="form-control" name="refund_id" value="{$refundInfo.id}" >
			<input type="hidden" class="form-control" name="status" placeholder="状态:-2:已撤销|-1:已拒绝|1:申请中|2:已同意|3:已打款" value="2" >
			<button type="submit" class="btn btn-info pull-right">确认退费</button>
		</div>
	</div>
</form>
</div>



<script src="/static/backend/plugins/jQuery/jquery-2.2.3.min.js"></script>
<script src="/static/backend/adminlte/js/bootstrap.min.js"></script>
<script src="/static/backend/adminlte/js/app.min.js"></script>
<!-- layui -->
<script src="/static/backend/layui/layui.js"></script>
<!-- 自定义 -->
<script src="/static/backend/adminlte/js/master.js"></script>
<script src="/static/backend/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/static/backend/plugins/datatables/dataTables.bootstrap.min.js"></script>
<script>


    $(function () {


        $('#billList').DataTable({
            'paging'      : true,
            'lengthChange': false,
            'searching'   : false,
            'ordering'    : true,
            'info'        : true,
            'autoWidth'   : true
        });


        //隔行变色
        $(".hotTable tbody td ul").find("li:even").addClass("even");


        $(".closeModel").on("click", function () {
            window.parent.closeModel();
        })

        $("input[name=refund]").on("blur",'', function () {
            var sum = parseFloat($(this).val());
            var maxSum = parseFloat($(".maxSum").text());
            if(sum>maxSum){
                alert("您所填写的实际退款金额不能大于可退金额"+maxSum+"!")
			}else{
                var forHOT = (maxSum-sum)*0.1;
                var forCamp = (maxSum-sum)*0.9;
                $(".getIncome").text("退款后剩余金额分配：平台"+forHOT.toFixed(2)+"（10%）训练营"+forCamp.toFixed(2)+"（90%）")
			}
        })

    })


</script>

</body>
</html>