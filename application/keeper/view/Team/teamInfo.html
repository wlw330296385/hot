<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>球队主页</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <!--标准mui.css-->
    <link rel="stylesheet" href="/static/frontend/css/mui.min.css">
    <!--自定义style.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/style.css" />
    <!--icon扩展样式icons-extra.css-->
    <link rel="stylesheet" type="text/css" href="/static/frontend/css/icons-extra.css" />
    <!--自定义多色图标icon.js-->
    <script src="/static/frontend/iconfont/iconfont.js"></script>
    <style>
        .mui-popover {
            height: 260px;
        }

        .coloricon {
            width: 2.3em;
            height: 2.3em;
            vertical-align: -0.7em;
            fill: currentColor;
            overflow: hidden;
        }

        .page-header .more {
            padding-right: 0px;
        }

        #arrRight {
            padding-top: 10px;
            float: right;
        }

        .nav-list .nav-list-frame .navli {
            width: 16.5%;
        }

        .integral {
            background: #fff;
            line-height: 40px;
        }

        .integral p {
            margin: 0;
        }

        .integral p a {
            color: #8f8f94;
        }

        @media screen and (min-width: 320px) {
            .imgShowEvent {
                width: 70% !important;
            }
        }

        @media screen and (min-width: 375px) {
            .imgShowEvent {
                width: 73% !important;
            }
        }

        @media screen and (min-width: 414px) {
            .imgShowEvent {
                width: 78% !important;
            }
        }

        .choiseFont .mui-input-row {
            height: 37px !important
        }

        .choiseFont .bgorange {
            color: #fff !important
        }
    </style>
</head>

<body>

    <header id="header" class="mui-bar mui-bar-transparent">
        <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left arrow"></a>
    </header>

    <div class="mui-content">

        <div class="detalis-list list coach mt55">

            <div class="img4x3" style="background-image:url('{$teamInfo.cover}')"></div>

            <ul class="mui-table-view mb" style="margin-top: -4px">
                <li class="mui-table-view-cell mui-media listli" style="padding:11px 15px;">
                    <img class="mui-media-object mui-pull-left coachicon" src="{$teamInfo.logo}" style="width:60px !important;height:60px !important;margin-top:5px">
                    <h4>{$teamInfo.name}</h4>
                    <div class="mui-media-body wd49" style="line-height:20px !important">
                        <p>{$teamInfo.city} {$teamInfo.area}</p>
                        <p class="f12">队员：
                            <strong class="colororange">{$teamInfo.member_num}</strong>人 |
                            <a href="{:url('team/fans',['team_id'=>$teamInfo['id']])}">粉丝：
                                <strong class="colororange">{$teamInfo.fans_num}</strong>
                            </a>
                        </p>
                    </div>
                    <div class="price-frame" style="padding:0">
                        <button type="button" class="mui-btn mui-btn-danger follow" style="padding: 8px 9px;">关注</button>
                    </div>
                </li>
            </ul>

            <!-- <div class="page-header whitebg mb">
                <a href="{:url('team/messagelist',['team_id'=>$teamInfo['id']])}">
                    <span class="course wd83">
                        <b class="colororange">公告</b>：欢迎新队员尼克杨加入F18加入大家庭！！</span>
                    <span class="more">更多</span>
                </a>
            </div> -->

            <ul class="mui-table-view mb">
                <li class="mui-table-view-cell listli detalisli">球队宣言
                    <span class="about mui-text-left">{$teamInfo.descri}</span>
                </li>
            </ul>

            <!--赛季数据-->
            <div class="page-header">
                <span class="course">2018赛季数据</span>
            </div>
            <div class="nav-list record mb">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <svg class="coloricon" aria-hidden="true">
                            <use xlink:href="#icon-home-game"></use>
                        </svg>
                        <span class="f14" style="display: block;">比赛</span>
                        <div class="mui-media-body f18 colororange">37</div>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <svg class="coloricon" aria-hidden="true">
                            <use xlink:href="#icon-home-Leaderboards"></use>
                        </svg>
                        <span class="f14" style="display: block;">效率</span>
                        <div class="mui-media-body f18 colororange">39</div>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <svg class="coloricon" aria-hidden="true">
                            <use xlink:href="#icon-home-VS"></use>
                        </svg>
                        <span class="f14" style="display: block;">锻炼</span>
                        <div class="mui-media-body f18 colororange">38</div>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <svg class="coloricon" aria-hidden="true">
                            <use xlink:href="#icon-home-team"></use>
                        </svg>
                        <span class="f14" style="display: block;">体质</span>
                        <div class="mui-media-body f18 colororange">36</div>
                    </li>
                </ul>
            </div>

            <!--球队战绩-->
            <div class="page-header">
                <span class="course">球队战绩</span>
                <span class="more pdr15">
                    <a href="{:url('team/matchList',['team_id'=>$teamInfo['id']])}" class="mui-navigate-right">查看更多</a>
                </span>
            </div>

            <div class="nav-list record mb">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <a href="#">
                            <span>场次</span>
                            <div class="mui-media-body colorred">{$teamInfo.match_num}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <a href="#">
                            <span>胜</span>
                            <div class="mui-media-body colorred">{$teamInfo.match_win}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <a href="#">
                            <span>负</span>
                            <div class="mui-media-body colorred">{$teamInfo.match_lose}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
                        <a href="#">
                            <span>胜率</span>
                            <div class="mui-media-body colorred">{$teamInfo.win_rate}</div>
                        </a>
                    </li>
                </ul>
            </div>

            <div class="mui-row mui-text-center integral">
                <div class="mui-col-xs-6 mui-col-sm-6">
                    <a href="#">
                        <p>年度积分：
                            <strong class="colororange">0</strong>
                        </p>
                    </a>
                </div>
                <div class="mui-col-xs-6 mui-col-sm-6">
                    <a href="#">
                        <p>赛区排名：
                            <strong class="colororange">0</strong>
                        </p>
                    </a>
                </div>
            </div>

            <div class="page-header">
                <span class="course">
                    球队成员
                </span>
                <span class="more pdr15">
                    <a href="{:url('team/teamMemberList',['team_id'=>$teamInfo['id']])}" class="mui-navigate-right">全部队员</a>
                </span>
            </div>

            <div class="nav-list mb">
                <a href="{:url('team/teamMemberList',['team_id'=>$teamInfo['id']])}">
                    <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame overflow-x teamMemberList ptb4"></ul>
                </a>
            </div>

            <div class="nav-list mb">
                <ul class="mui-table-view mui-grid-view mui-grid-9 nav-list-frame">
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>平均年龄</span>
                            <div class="mui-media-body">{$teamInfo.avg_age}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>平均身高</span>
                            <div class="mui-media-body">{$teamInfo.avg_height}</div>
                        </a>
                    </li>
                    <li class="mui-table-view-cell mui-media mui-col-xs-4 mui-col-sm-4">
                        <a href="#">
                            <span>平均体重</span>
                            <div class="mui-media-body">{$teamInfo.avg_weight}</div>
                        </a>
                    </li>
                </ul>
            </div>

            <!--最新赛事-->
            <div class="page-header border-b">
                <span class="course">最新赛事
                    <span class="noDataTip"></span>
                </span>
                <span class="more pdr15">
                    <a href="{:url('index/lateLyMatchList',['team_id'=>$teamInfo['id']])}/?team_id={$teamInfo.id}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view detalis-list list mainInfo border-b newMatch"></ul>

            <!--赛事纪录-->
            <div class="page-header border-b">
                <span class="course">赛事纪录
                    <span class="noDataTip"></span>
                </span>
                <span class="more pdr15">
                    <a href="{:url('team/matchList',['team_id'=>$teamInfo['id']])}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view detalis-list list mui-text-center mainInfo border-b recordMatch"></ul>

            <!--最新活动-->
            <div class="page-header border-b">
                <span class="course">最新活动
                    <span class="noDataTip"></span>
                </span>
                <span class="more pdr15">
                    <a href="{:url('index/lateLyEventList',['team_id'=>$teamInfo['id']])}/?team_id={$teamInfo.id}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view detalis-list list mainInfo border-b newEvent"></ul>

            <!--活动纪录-->
            <div class="page-header border-b">
                <span class="course">活动纪录
                    <span class="noDataTip"></span>
                </span>
                <span class="more pdr15">
                    <a href="{:url('team/eventList',['team_id'=>$teamInfo['id']])}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view detalis-list list mainInfo border-b recordEvent"></ul>

            <!--荣誉-->
            <div class="page-header border-b">
                <span class="course">荣誉
                    <span class="noDataTip"></span>
                </span>
                <span class="more pdr15">
                    <a href="{:url('team/honorList',['team_id'=>$teamInfo['id']])}" class="mui-navigate-right">更多</a>
                </span>
            </div>
            <ul class="mui-table-view detalis-list list mainInfo border-b honor"></ul>

            <!--球队相册-->
            <!-- <div class="page-header whitebg border-b">
                <span class="course">球队相册</span>
                <span class="more pdr15">
                    <a href="{:url('team/album',['team_id'=>$teamInfo['id']])}" class="mui-navigate-right">查看更多</a>
                </span>
            </div>
            <div class="picFrame whitebg">
                <ul>
                    <li>
                        <img src="/static/frontend/images/ads1.jpg">
                    </li>
                    <li>
                        <img src="/static/frontend/images/ads1.jpg">
                    </li>
                    <li>
                        <img src="/static/frontend/images/ads1.jpg">
                    </li>
                    <li>
                        <img src="/static/frontend/images/ads1.jpg">
                    </li>
                </ul>
            </div> -->

            <!--球队印象-->
            <div class="page-header border-b">
                <span class="course">球队印象
                    <span class="noDataTip"></span>
                </span>
                <span class="more pdr15">
                    <a href="#Impress" class="mui-navigate-right myimpress">发表我的印象</a>
                </span>
            </div>
            <!-- <div class="impress whitebg tagCommentList mb"></div> -->
            <div class="impress whitebg tagCommentList border-b"></div>

            <!-- 球队介绍 -->
            <div class="page-header border-b">
                <span class="course">球队介绍
                    <span class="noDataTip"></span>
                </span>
            </div>
            <ul class="mui-table-view mb">
                <li class="mui-table-view-cell listli introBox" style="padding:0 !important">{$teamInfo.introduce}</li>
            </ul>

            <!-- 球队评论 -->
            <div class="page-header border-b">
                <span class="course wd52">评论</span>
                <span class="more f14">评论
                    <span class="comment_count">0</span>&nbsp;|&nbsp;
                    <i class="mui-icon-extra mui-icon-extra-like f16 thumbsup"></i>&nbsp;
                    <span class="thumbup_count">0</span>
                </span>
            </div>
            <ul class="mui-table-view comment-list"></ul>


            <!--推荐人信息-->
            {notempty name="pmember"}
            <p class="pline"></p>
            <div class="mui-row recommend">
                <div class="mui-col-sm-3 mui-col-xs-3 recomLine"></div>
                <div class="mui-col-sm-2 mui-col-xs-2 recomTxt">分享者</div>
                <div class="mui-col-sm-2 mui-col-xs-2">
                    <img src="{$pmember['avatar']}">
                </div>
                <div class="mui-col-sm-2 mui-col-xs-2 recomTxt">{$pmember.nickname}</div>
                <div class="mui-col-sm-3 mui-col-xs-3 recomLine"></div>
            </div>
            {/notempty}


            <!--底部操作-->
            <ul class="mui-table-view operation mt">
                <li class="mui-table-view-cell mui-col-sm-2 mui-col-xs-2 opli">
                    <a href="{$homeurl}">
                        <span class="mui-icon icon iconfont icon-nav-Home"></span>
                    </a>
                </li>
                <li class="mui-table-view-cell mui-col-sm-2 mui-col-xs-2 opli">
                    <a href="#shareGuide">分享</a>
                </li>
                {eq name="isMemberInTeam" value="1"}
                <li class="mui-table-view-cell mui-col-sm-3 mui-col-xs-3 opli">
                    <a href="{:url('team/teammanage',['team_id'=>$teamInfo['id']])}">
                        球队管理
                    </a>
                </li>
                {else/}
                <li class="mui-table-view-cell mui-col-sm-3 mui-col-xs-3 opli bggreen">
                    <a href="#yqpopover">申请加入</a>
                </li>
                {/eq}
                <li class="mui-table-view-cell mui-col-sm-3 mui-col-xs-3 opli bgred">
                    <a href="#matchPK" class="">发起约战</a>
                </li>
                <li class="mui-table-view-cell mui-col-sm-2 mui-col-xs-2 opli bgblue">
                    <a href="#fbcomment">评论 </a>
                </li>
            </ul>

        </div>
    </div>

    <!-- 加入球队弹框 -->
    <div id="yqpopover" class="mui-popover mui-popover-action mui-popover-bottom actionsheet">
        <div class="list camp-list camp-lesson-list detalis-list grade-list coach">
            <ul class="mui-table-view operation">
                <h5>
                    <span class="type">申请加入</span>
                    <a href="#yqpopover" class="mui-icon mui-icon-closeempty"></a>
                </h5>
                <li class="listli">
                    <textarea rows="4" class="remarks" placeholder="请填写你加入球队的理由"></textarea>
                </li>
                <li class="mui-col-xs-12 opli joinBtn">提交申请</li>
            </ul>
        </div>
    </div>
    <!-- 发表印象 -->
    <div id="Impress" class="mui-popover mui-popover-action mui-popover-bottom actionsheet">
        <div class="list">
            <ul class="mui-table-view operation">
                <h5>
                    <span>我的印象</span>
                    <a href="#Impress" class="mui-icon mui-icon-closeempty"></a>
                </h5>
                <div class="impressSide whitebg tagAll"></div>
                <li class="mui-col-xs-12 opli impressBtn" id="impressSubmit">提交</li>
            </ul>
        </div>
    </div>

    <!--分享-->
    <div id="shareGuide" class="mui-popover">
        <div class="shareGuideText">1、点击右上角的
            <span class="shareEllipsis">···</span>
            <img src="/static/frontend/images/esp.png" alt="">
        </div>
        <div class="shareGuideText">2、选择发送给朋友或分享到朋友圈</div>
    </div>

    <!-- 发表评论 -->
    <div id="fbcomment" class="mui-popover mui-popover-action mui-popover-bottom actionsheet">
        <div class="list">
            <ul class="mui-table-view operation">
                <h5>
                    <span class="type">评价一下</span>
                    <a href="#fbcomment" class="mui-icon mui-icon-closeempty"></a>
                </h5>
                <li class="listli">
                    <textarea rows="4" class="comment" placeholder="评价一下这个球队吧。"></textarea>
                </li>
                <li class="mui-col-xs-12 opli commentBtn">发表</li>
            </ul>
        </div>
    </div>

    <!-- 发起约战信息填写 -->
    <div id="matchPK" class="mui-popover mui-popover-action mui-popover-bottom actionsheet">
        <ul class="mui-table-view operation" style="margin:0 !important">
            <h5>
                <span class="type">请选择球队和比赛</span>
                <a href="#matchPK" class="mui-icon mui-icon-closeempty"></a>
            </h5>
            <div class="mui-card" style="margin:0 !important;border-radious:0 !important">
                <ul class="mui-table-view mui-text-left" style="margin:0 !important">
                    <li class="mui-table-view-cell mui-collapse teamli">
                        <a class="mui-navigate-right" href="#">
                            <strong>所属球队</strong>
                        </a>
                        <div class="mui-collapse-content">
                            <form class="mui-input-group choiseFont">
                                <div class="mui-input-row choiseTeam">
                                    <a href="{:url('team/createTeam')}">
                                        <label style="width:100% !important">
                                            创建球队
                                        </label>
                                    </a>
                                </div>
                            </form>
                        </div>
                    </li>
                    <li class="mui-table-view-cell mui-collapse matchli">
                        <a class="mui-navigate-right" href="#">
                            <strong>所属球队比赛</strong>
                        </a>
                        <div class="mui-collapse-content">
                            <form class="mui-input-group choiseFont">
                                <div class="mui-input-row choiseMatch">
                                    <label class="createMatch" style="width:100% !important">
                                        创建比赛
                                    </label>
                                </div>
                            </form>
                        </div>
                    </li>
                </ul>
            </div>
        </ul>
    </div>

    <script src="/static/frontend/js/mui.min.js"></script>
    <script src="/static/frontend/js/jquery-3.2.1.min.js"></script>
    <script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
    <script>
        mui.init({
            swipeBack: false
        });
        (function ($) {
            $('.mui-scroll-wrapper').scroll({
                indicators: true //是否显示滚动条
            });
        })(mui);
        $(function () {
            var count = 1;
            // 判断是否登陆
            if ("{$memberInfo.id}" <= 0) {
                mui.confirm('请完善您的信息，以便进行后续操作，谢谢！', '提示', ['取消', '前往完善'], function (e) {
                    if (e.index === 1) {
                        window.location.href = "{$fasturl}";
                    }
                });
                return false;
            }

            //球队详细介绍内容
            var introduce = '{$teamInfo.introduce}';
            if (introduce == '') {
                $(".introBox").append("<p class='nohave' style='margin-left:0'>该球队还没有图文简介哦</p>")
            }

            // 印象评价
            $(document).on("tap", '.impressSide .choiseTag', function () {
                if ($(this).hasClass("bgorange")) {
                    $(this).removeClass("bgorange");
                } else {
                    $(this).addClass("bgorange");
                }
            });

            $(document).on("tap", '.myimpress', function () {
                $(".impressSide .bgorange").removeClass("bgorange");
            });

            // 关注球队
            $(".follow").on("tap", '', function () {
                var team_id = "{$teamInfo.id}";
                mui.ajax("{:url('api/follow/focus')}", {
                    data: {
                        type: 4,
                        team_id: team_id
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        //服务器返回响应，根据响应结果，分析是否登录成功；
                        console.log(data);
                        if (data.code == 200) {
                            mui.toast(data.msg);
                            followStatus();
                        } else {
                            mui.toast(data.msg);
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });

            // 申请加入球队
            $(".joinBtn").on("tap", '', function () {
                var team_id = "{$teamInfo.id}";
                var remarks = $(".remarks").val();

                if (remarks == '') {
                    mui.toast("请填写申请理由");
                    return false;
                }

                mui.ajax("{:url('api/team/applyjointeam')}", {
                    data: {
                        team_id: team_id,
                        remarks: remarks
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        //服务器返回响应，根据响应结果，分析是否登录成功；
                        console.log(data);
                        if (data.code == 200) {
                            mui.toast("操作成功，待球队审核...");
                            mui('#yqpopover').popover('toggle');
                        } else {
                            mui.toast(data.msg);
                            mui('#yqpopover').popover('toggle');
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });

            //评论功能
            $(".commentBtn").on('tap', function () {
                var commented_id = "{$teamInfo.id}";
                var comment = $(".comment").val();

                if (comment == '') {
                    mui.toast("评价内容不能为空哦");
                    return false;
                }

                mui.ajax("{:url('api/team/addteamcomment')}", {
                    data: {
                        commented_id: commented_id,
                        comment_type: 1,
                        comment: comment
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        console.log(data);
                        if (data.code == 200) {
                            mui.toast('评价成功，感谢你的评价！');
                            $(".comment-list").empty();
                            toCommentList();
                            mui('#fbcomment').popover('toggle');
                        } else {
                            mui.toast(data.msg);
                            mui('#fbcomment').popover('toggle');
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });

            // 发表印象标签
            $(".impressBtn").on("tap", '', function () {
                var commented = "{$teamInfo.name}";
                var commented_id = "{$teamInfo.id}";

                var tags = $(".tagAll .bgorange").map(function () {
                    return $(this).attr("data-tag_name");
                }).get().join(",");

                var tag_ids = $(".tagAll .bgorange").map(function () {
                    return $(this).attr("data-id");
                }).get().join(",");

                if (!$(".tagAll .choiseTag").hasClass("bgorange")) {
                    mui.toast("你还没有选择印象标签哦");
                    return false;
                }

                mui.ajax("{:url('api/tag/addtagcomment')}", {
                    data: {
                        comment_type: 2,
                        commented: commented,
                        commented_id: commented_id,
                        tags: tags,
                        tag_ids: tag_ids,
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        console.log(data);
                        if (data.code == 200) {
                            mui.toast("发表成功，感谢你的评价！");
                            toTagCommentList();
                            mui('#Impress').popover('toggle');
                        } else {
                            mui.toast(data.msg);
                            mui('#Impress').popover('toggle');
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });

            //比赛报名功能
            $(document).on('tap', '.signupMatchBtn', function () {
                //判断是否登陆会员
                var match_id = matchid;
                mui.ajax("{:url('api/match/joinmatch')}", {
                    data: {
                        match_id: matchid,
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        console.log(data);
                        if (data.code == 200) {
                            mui.alert('报名成功', '确定');
                        } else {
                            mui.toast(data.msg);
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });

            //活动报名功能
            $(document).on('tap', '.signupEventBtn', function () {
                //判断是否登陆会员
                var event_id = eventid;
                mui.ajax("{:url('api/team/jointeamevent')}", {
                    data: {
                        event_id: eventid,
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        console.log(data);
                        if (data.code == 200) {
                            mui.alert('报名成功', '确定');
                        } else {
                            mui.toast(data.msg);
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });


            //点赞功能
            $(".thumbsup").on('tap', function () {
                var commented_id = "{$teamInfo.id}";
                mui.ajax("{:url('api/team/dianzan')}", {
                    data: {
                        commented_id: commented_id,
                        comment_type: 1,
                    },
                    dataType: 'json',//服务器返回json格式数据
                    type: 'post',//HTTP请求类型
                    timeout: 10000,//超时时间设置为10秒；
                    headers: { 'Content-Type': 'application/json' },
                    success: function (data) {
                        console.log(data);
                        if (data.code == 200) {
                            $(".thumbup_count").text(data.thumbup_count);
                            isthumbsup();
                        } else {
                            mui.toast(data.msg);
                        }
                    },
                    error: function (xhr, type, errorThrown) {
                        //异常处理；
                        console.log(type);
                    }
                });
            });

            isthumbsup() //点赞状态
            followStatus(); //判断当前的关注状态
            teamMemberlist(); //自定义获取球员列表
            toTagAllList(); //所有标签列表
            toTagCommentList(); //已经评价的标签列表
            toLastEventList() //获取最新活动列表
            toLastMatchList(); //获取最新比赛列表
            toCommentList(); //获取评论列表
            toRecordEventList(); //活动纪录
            toRecordMatchList(); //赛事纪录
            toTeam(); //获取所在的球队列表
            toHonorList(); //荣誉列表
        });

        // 点赞状态
        function isthumbsup() {
            var commented_id = "{$teamInfo.id}";
            mui.ajax("{:url('api/team/isthumbup')}", {
                data: {
                    commented_id: commented_id,
                    comment_type: 1,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data);
                    if (data.code == 200) {
                        $(".thumbup_count").text(data.thumbsup_count);
                        if (data.thumbsup == 1) {
                            $(".thumbsup").css("color", "red");
                        } else {
                            $(".thumbsup").css("color", "#737373");
                        }
                    } else {
                        mui.toast(data.msg);
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        }

        // 判断当前的关注状态
        function followStatus() {
            var team_id = "{$teamInfo.id}"
            mui.ajax("{:url('api/follow/getfollow')}", {
                data: {
                    type: 4,
                    team_id: team_id
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data);
                    if (data.code == 200) {
                        if (data.data === 1) {
                            $(".follow").text("取消关注");
                        } else {
                            $(".follow").text("关注");
                        }
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        }

        //自定义获取球员列表
        function teamMemberlist() {
            var url = "{:url('api/team/teammemberlist','','',true)}";
            var team_id = "{$teamInfo.id}";
            mui.ajax({
                url: url,
                data: {
                    team_id: team_id,
                    status: 1
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    if (data.code == 200) {
                        var newli = '';
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            newli += '<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3 navli logostyle" id="logoframe"><img class="logostyle" src="' + data.data[i].avatar + '" alt="">'
                            newli += '<div class="mui-media-body role">' + data.data[i].member + '</div>'
                            newli += '</li>'
                        }
                        $(".teamMemberList").empty();
                        if (newli == '') {
                            newli = '<p class="mui-text-center">没有查找到数据哦</p>'
                        }
                        $(".teamMemberList").append(newli);


                    } else {
                        mui.toast('数据获取失败,请稍候再试');
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                }
            });
        };

        //获取所有标签列表
        function toTagAllList() {
            mui.ajax("{:url('api/tag/tagall')}", {
                data: {
                    comment_type: 1
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var div = '';
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            div = div + '<span class="choiseTag" data-tag_name="' + data.data[i].tag_name + '" data-id="' + data.data[i].id + '">' + data.data[i].tag_name + '</span>'
                        }
                        $(".tagAll").empty();
                        $(".tagAll").append(div);

                        if (div == '') {
                            $(".tagAll").append('<li class="nohave"><p>没有相关数据哦</p></li>');
                        }
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        };

        //获取已评价标签列表
        function toTagCommentList() {
            mui.ajax("{:url('api/tag/commentlist')}", {
                data: {
                    comment_type: 2,
                    commented_id: "{$teamInfo.id}",
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var div = '';
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            div = div + '<span class="choiseTag" data-tag_name="' + data.data[i].tag + '" data-tag_id="' + data.data[i].id + '">' + data.data[i].tag + '(<samll>' + data.data[i].count + '</samll>)</span>'
                        }
                        $(".tagCommentList").empty();
                        $(".tagCommentList").append(div);
                    } else {
                        $(".tagCommentList").prev().find(".noDataTip").append("（暂无数据）");
                        $(".tagCommentList").removeClass("impress");
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        };
        //下拉刷新具体业务实现
        function pulldownRefresh() {
            setTimeout(function () {
                count = 1;//刷新并显示第一页
                var page = count;
                var gType = 1;//代表下拉刷新
                toCommentList(page, gType);//具体取数据的方法
            }, 100);
        }
        //上拉加载具体业务实现
        function pullupRefresh() {
            setTimeout(function () {
                count++;//翻下一页
                var page = count;
                var gType = 2;//代表上拉加载
                toCommentList(page, gType);//具体取数据的方法
            }, 100);
        }
        //获取评论列表
        function toCommentList(page, gType) {
            var url = "{:url('api/team/teamcommentlist','','',true)}/?page=" + page;
            var commented_id = "{$teamInfo.id}";
            mui.ajax({
                url: url,
                data: {
                    commented_id: commented_id,
                    comment_type: 1,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var newli = '';
                    if (data.code == 200) {
                        $(".comment_count").text(data.data.length);
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            newli = newli + '<li class="mui-table-view-cell listli"><div class="mui-pull-right">' + data.data[i].create_time + '</div><img class="mui-pull-left coachicon" src="' + data.data[i].member_avatar + '">' + data.data[i].member + '<p>' + data.data[i].comment + '</p></li>'
                        }
                    } else {
                        $("ul.comment-list").html('<li class="nodata"><i class="icon iconfont icon-logo-Big"></i><p>还没有评论哦，你来说几句吧！</p></li>');
                    }
                    if (gType == 1) {
                        //上拉刷新
                        $("ul.comment-list").empty().append(newli);
                    } else {
                        //下拉加载 gType==2
                        $("ul.comment-list").append(newli);
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                }
            });
        };

        var eventid = ''
        //获取最新活动列表
        function toLastEventList() {
            var team_id = "{$teamInfo.id}";
            mui.ajax("{:url('api/team/lastevent')}", {
                data: {
                    team_id: team_id,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var div = '';
                    if (data.code == 200) {
                        // 将时间戳转成日期格式
                        var Tmonth = gettimem(data.data[0].start_time_stamp * 1000);
                        var Tday = gettimed(data.data[0].start_time_stamp * 1000);
                        var Ttime = gettimeh(data.data[0].start_time_stamp * 1000);
                        eventid = data.data[0].id
                        var url = "{:url('team/eventinfo')}" + '/team_id/' + data.data[0].team_id + '/event_id/' + data.data[0].id;
                        div += ' <li class="mui-table-view-cell mui-media listli liFrame"><div class="mainInfoLeft fl mui-text-center"><p class="month bgblack">' + Tmonth + '月</p><h1 class="day colorgreen">' + Tday + '</h1><p class="hours">' + Ttime + '</p></div>';
                        div += '<div class="mui-media-body mainInfoRight wd66"><h5 class="title">' + data.data[0].event + '</h5>';
                        div += '<div class="divFrame"><p>发起人：' + data.data[0].member + '</p><p>活动地点：' + data.data[0].location + '</p><p>活动类型：' + data.data[0].event_type + '</p></div><div class=opFrame><button class="mui-btn opbtn" style="margin-right: 8px"><a href="' + url + '">详情</a></button>';
                        if (data.data[0].is_finished_num == 1) {
                            div += '<button class="mui-btn opbtn bggray">已结束</button>';
                        } else {
                            div += '<button class="mui-btn opbtn bggreen signupEventBtn">参加</button>';
                        }
                        div += ' </div></div></li>';
                        // 人员头像版块
                        div += '<li class="mui-table-view-cell listli liImgFrame"><div class="imgShow fl overflow-x imgShowEvent" style="padding:0 !important">';
                        for (var j = 0; j <= data.data[0].memberlist.length - 1; j++) {
                            div += '<img src="' + data.data[0].memberlist[j].avatar + '" alt="">';
                        }
                        div += '</div><span class="singUpTip"><font class="colorred reg_number">' + data.data[0].reg_number + '</font>/<font class="reg_all">' + data.data[0].max + '</font> 已报名</span></li>';
                        // }
                        $(".newEvent").empty().append(div);
                    }
                    if (data.code == 100) {
                        $(".newEvent").prev().find(".noDataTip").append("（暂无数据）");
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        };

        //获取活动纪录列表
        function toRecordEventList() {
            var url = "{:url('api/team/teameventlist','','',true)}";
            var team_id = "{$teamInfo.id}";
            mui.ajax({
                url: url,
                data: {
                    team_id: team_id,
                    status: 1,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var newli = '';
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            var urls = "{:url('team/eventInfo')}" + '/event_id/' + data.data[i].id + '/team_id/' + "{$team_id}";
                            newli += '<li class="mui-table-view-cell mui-media listli">'
                            newli += '<a href="' + urls + '" class="mui-navigate-right"><img class="mui-media-object mui-pull-left" src="' + data.data[i].cover + '" style="width:70px!important;height: 56px!important;"><div class="mui-media-body" style="width:51%">' + data.data[i].event + '';
                            if (data.data[i].is_max == "已满人") {
                                newli += '<font class="tipCorner bgred">满人</font>';
                            }
                            if (data.data[i].is_finished == "已结束") {
                                newli += '<font class="tipCorner bggray">结束</font>';
                            }
                            newli += '<p class="mui-ellipsis">' + data.data[i].create_time + '</p></div><div class="price-frame rightLocation">' + data.data[i].reg_number + '人参与</div></a>'
                            newli += '</li>';
                        }
                    }
                    $("ul.recordEvent").empty().append(newli);
                    if (newli == '') {
                        $(".recordEvent").prev().find(".noDataTip").append("（暂无数据）");
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                    mui('#refreshContainer').pullRefresh().endPullupToRefresh(true);
                }
            });
        };

        var matchid = ''
        //获取最新比赛列表
        function toLastMatchList() {
            var team_id = "{$teamInfo.id}";
            mui.ajax("{:url('api/team/lastmatch')}", {
                data: {
                    team_id: team_id,
                    status: 1
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var div = '';
                    if (data.code == 200) {
                        // 将时间戳转成日期格式
                        var Tmonth = gettimem(data.data[0].match_timestamp * 1000);
                        var Tday = gettimed(data.data[0].match_timestamp * 1000);
                        var Ttime = gettimeh(data.data[0].match_timestamp * 1000);
                        matchid = data.data[0].id
                        var url = "{:url('team/matchinfo')}" + '/team_id/' + data.data[0].team_id + '/match_id/' + data.data[0].match_id;
                        div += ' <li class="mui-table-view-cell mui-media listli liFrame"><div class="mainInfoLeft fl mui-text-center">';
                        if (data.data[0].match_time == 0 || data.data[0].match_time == "1970-01-01 08:00") {
                            div += '<p class="month bgblack">0月</p><h1 class="day" style="font-size: 25px;padding: 15px 21px;">待定</h1><p class="hours">00:00</p>';
                        } else {
                            div += '<p class="month bgblack">' + Tmonth + '月</p><h1 class="day colorred">' + Tday + '</h1><p class="hours">' + Ttime + '</p>';
                        }
                        div += '</div><div class="mui-media-body mainInfoRight wd66"><h5 class="title">' + data.data[0].match + '</h5><div class="divFrame">';
                        div += '<p>发起人：' + data.data[0].home_team + '</p>';
                        div += '<p>比赛地点：' + data.data[0].court + '</p><p>比赛类型：' + data.data[0].type + '</p></div><div class=opFrame><button class="mui-btn opbtn" style="margin-right: 8px"><a href="' + url + '">详情</a></button>';
                        if (data.data[0].is_finished_num == 1) {
                            div += '<button class="mui-btn opbtn bggray">已结束</button>';
                        } else {
                            div += '<button class="mui-btn opbtn bgred signupMatchBtn">参加</button>';
                        }
                        div += ' </div></div></li>';
                        // 人员头像版块
                        div += '<li class="mui-table-view-cell listli liImgFrame"><div class="imgShow fl overflow-x imgShowEvent" style="padding:0 !important">';
                        for (var j = 0; j <= data.data[0].memberlist.length - 1; j++) {
                            div += '<img src="' + data.data[0].memberlist[j].avatar + '" alt="">';
                        }
                        div += '</div><span class="singUpTip"><font class="colorred reg_number">' + data.data[0].reg_number + '</font>/<font class="reg_all">' + data.data[0].max + '</font> 已报名</span></li>';
                        $(".newMatch").empty().append(div);
                    }
                    if (data.code == 100) {
                        $(".newMatch").prev().find(".noDataTip").append("（暂无数据）");
                    }
                },
                error: function (xhr, type, errorThrown) {
                    //异常处理；
                    console.log(type);
                }
            });
        };

        //获取赛事纪录列表
        function toRecordMatchList() {
            var url = "{:url('api/match/matchrecordlist','','',true)}";
            var team_id = "{$teamInfo.id}";
            mui.ajax({
                url: url,
                data: {
                    team_id: team_id,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var newli = '';
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.slice(0, 5).length - 1; i++) {
                            // 将时间戳转成日期格式
                            var matchTimeM = gettimeM(data.data[i].match_timestamp * 1000);
                            var matchTimeY = gettimeY(data.data[i].match_timestamp * 1000);
                            var urls = "{:url('team/matchInfo')}" + '/match_id/' + data.data[i].match_id + '/team_id/' + "{$team_id}";
                            newli += '<li class="mui-table-view-cell"><a href="' + urls + '"><ul class="mui-row" style="padding:0">'
                            newli += '<li class="mui-col-xs-1 mui-col-sm-1" style="line-height: 36px;"><p>' + (data.data.slice(0, i).length + 1) + '</p></li><li class="mui-col-xs-3 mui-col-sm-3"><p>' + matchTimeY + '</p><p>' + matchTimeM + '</p></li><li class="mui-col-xs-4 mui-col-sm-4" style="line-height: 36px;">';
                            if (data.data[i].home_score > data.data[i].away_score) {
                                newli += '<p class="colororange">' + data.data[i].away_team + '</p></li><li class="mui-col-xs-3 mui-col-sm-3" style="line-height: 36px;"><p class="colororange">' + data.data[i].home_score + ':' + data.data[i].away_score + '</p></li><li class="mui-col-xs-1 mui-col-sm-1" style="line-height: 36px;">';
                            } else {
                                newli += '<p>' + data.data[i].away_team + '</p></li><li class="mui-col-xs-3 mui-col-sm-3" style="line-height: 36px;"><p>' + data.data[i].home_score + ':' + data.data[i].away_score + '</p></li><li class="mui-col-xs-1 mui-col-sm-1" style="line-height: 36px;">';
                            }
                            if (data.data[i].home_score > data.data[i].away_score) {
                                newli += '<p class="colororange">胜</p>'
                            } else if (data.data[i].home_score < data.data[i].away_score) {
                                newli += '<p>负</p>'
                            } else {
                                newli += '<p>--</p>'
                            }
                            newli += '</li></ul></a></li>'
                        }
                    }
                    $("ul.recordMatch").empty().append(newli);
                    if (newli == '') {
                        $(".recordMatch").prev().find(".noDataTip").append("（暂无数据）");
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                    mui('#refreshContainer').pullRefresh().endPullupToRefresh(true);
                }
            });
        };
        var teamId = '';
        var teamM = '';
        //获取在队的球队列表
        function toTeam() {
            var url = "{:url('api/team/myteamlist','','',true)}";
            mui.ajax({
                url: url,
                data: {
                    status: 1
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var newli = '';
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            newli = newli + '<div class="mui-input-row"><label class="choiseDiv" style="width:100% !important" data-team_id="' + data.data[i].team.id + '">' + data.data[i].team.name + '</label></div>'
                        }
                        $(newli).insertAfter(".choiseTeam");
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                }
            });
        };

        $(".createMatch").on("tap", function () {
            if (teamId == '') {
                mui.toast("请先选择球队");
            } else {
                var urls = "{:url('team/createMatch')}" + "/team_id/" + teamId
                window.location.href = urls
            }
        })

        $(document).on("tap", ".choiseDiv", function () {
            $(".choiseDiv").removeClass("bgorange");
            $(this).addClass("bgorange");
            $(".teamli").removeClass("mui-active");
            $(".matchli").addClass("mui-active");
            teamId = $(this).attr("data-team_id");
            toMatch();
        });

        function toMatch() {
            //获取在队的球队比赛列表
            var url = "{:url('api/match/matchrecordlistall','','',true)}";
            mui.ajax({
                url: url,
                data: {
                    status: 1,
                    team_id: teamId,
                    away_team: "",
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var newli = '';
                    textM = data.code
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.length - 1; i++) {
                            var url = "{:url('team/createMatch')}" + "/team_id/" + teamId + "/away_id/{$teamInfo.id}"
                            newli = newli + '<div class="mui-input-row"><label style="width:100% !important" data-match_id="' + data.data[i].id + '"><a href="' + url + '">' + data.data[i].match + '</a></label></div>'
                        }
                        $(".choiseMatch").nextAll().remove();
                        $(newli).insertAfter(".choiseMatch");
                    } else {
                        var btnArray = ['取消', '确认'];
                        mui.confirm('该球队还没有比赛记录，去创建比赛吧', '', btnArray, function (e) {
                            if (e.index == 1) {
                                window.location.href = "{:url('team/createMatch')}" + "/team_id/" + teamId;
                            }
                        });
                        $(".choiseMatch").nextAll().remove();
                        $("<div class='colorgray' style='padding: 11px 15px;'>该球队还没有比赛记录</div>").insertAfter(".choiseMatch");
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                }
            });
        }

        //获取荣誉列表
        function toHonorList() {
            var url = "{:url('api/team/lastteamhonorlist','','',true)}";
            var team_id = "{$teamInfo.id}";
            mui.ajax({
                url: url,
                data: {
                    author_team_id: team_id,
                    status: 1,
                },
                dataType: 'json',//服务器返回json格式数据
                type: 'post',//HTTP请求类型
                timeout: 10000,//超时时间设置为10秒；
                headers: { 'Content-Type': 'application/json' },
                success: function (data) {
                    console.log(data)
                    var newli = '';
                    if (data.code == 200) {
                        for (var i = 0; i <= data.data.slice(0, 5).length - 1; i++) {
                            var urls = "{:url('team/honorinfo')}" + '/honor_id/' + data.data[i].id + '/team_id/' + data.data[i].author_team_id;
                            newli += '<li class="mui-table-view-cell listli"><a href="' + urls + '">';
                            newli += '<div class="mui-media-body wd83">奖项名称：<strong class="colororange f16"> ' + data.data[i].name + '</strong><p class="mui-ellipsis lineHeight20" >授奖单位： ' + data.data[i].award_org + '</p ><p class="mui-ellipsis lineHeight20">授奖日期：' + data.data[i].honor_time + '</p></div >'
                            newli += '</a></li >';
                        }
                    }
                    $("ul.honor").empty().append(newli);
                    if (newli == '') {
                        $(".honor").prev().find(".noDataTip").append("（暂无数据）");
                    }
                },
                error: function (xhr, type, errerThrown) {
                    mui.toast('网络异常,请稍候再试');
                    mui('#refreshContainer').pullRefresh().endPullupToRefresh(true);
                }
            });
        };

        //创建补0函数
        function p(s) {
            return s < 10 ? '0' + s : s;
        }
        function gettimem(m) {
            var _time = new Date(m);
            var month = _time.getMonth() + 1;
            return p(month);
        }
        function gettimed(d) {
            var _time = new Date(d);
            var day = _time.getDate();
            return p(day);
        }
        function gettimeh(h) {
            var _time = new Date(h);
            var hours = _time.getHours();
            var minutes = _time.getMinutes();
            return p(hours) + ":" + p(minutes);
        }
        // 将时间戳转成日期格式
        function gettimeM(M) {
            var _time = new Date(M);
            var month = _time.getMonth() + 1;
            var day = _time.getDate();
            return p(month) + "月" + p(day) + "日"
        }
        function gettimeY(Y) {
            var _time = new Date(Y);
            var year = _time.getFullYear();
            return p(year) + "年";
        }
    </script>
    <script>
        wx.config({
            //debug: true,
            appId: "{$jsapi['appId']}",
            timestamp: "{$jsapi['timestamp']}",
            nonceStr: "{$jsapi['nonceStr']}",
            signature: "{$jsapi['signature']}",
            jsApiList: [
                // 所有要调用的 API 都要加到这个列表中
                'checkJsApi',
                'onMenuShareTimeline',
                'onMenuShareAppMessage',
                'onMenuShareQQ'
            ]
        });
        wx.ready(function () {
            // 分享到朋友圈
            wx.onMenuShareTimeline({
                title: "{$teamInfo.name}",
                link: "{$shareurl}/pid/{$mid}",
                imgUrl: "{:request()->root(true)}{$teamInfo.logo}",
                success: function () { },
                cancel: function () { }
            });
            // 分享给朋友
            wx.onMenuShareAppMessage({
                title: "{$teamInfo.name}",
                desc: "{$teamInfo.descri}",
                link: "{$shareurl}/pid/{$mid}",
                imgUrl: "{:request()->root(true)}{$teamInfo.logo}",
                type: "",
                dataUrl: '',
                success: function () { },
                cancel: function () { }
            });

        });
    </script>
</body>

</html>